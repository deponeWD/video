<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="robots" content="index,follow">
    <meta name="author" content="Daniel Ehniss, DEPONE Netzgestaltung">
    <meta name="keywords" content="Video, Thumbnail, Vimeo, YouTube, Javascript">
    <meta name="description" content="A tool to get thumbnail of video hosted on YouTube or Vimeo.">
    <title>Get Thumbnail of a Video</title>
    <style>
      *,
      *:before, *:after {
        box-sizing: border-box;
      }

      body {
        background-color: rgb(247,247,247);
        color: rgb(51,51,51);
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 100%;
        margin: 0;
        padding: 0;
      }

      section#main {
        font-size: 1.4rem;
        line-height: 1.4;
        margin: 3rem auto;
        max-width: 680px;
        width: 90%;
      }

      h1 {
        font-size: 2em;
        line-height: 1;
      }

      a,
      a:visited {
        color: rgb(229,23,23);
        transition: color 0.2s ease-out;
      }

      a:hover,
      a:focus {
        color: rgb(153,0,0);
      }

      p.additional {
        font-size: 0.7em;
      }

      form {
        background-color: #ccc;
        border-radius: 3px;
        border: 1px solid;
        padding: 1em 5%;
        width: 100%;
      }

      label {
        line-height: 1;
        display: block;
      }

      input,
      a.download {
        border: 1px solid;
        border-radius: 3px;
        display: block;
        font-family: inherit;
        font-size: inherit;
        padding: 0.25rem 1.5%;
        margin: 0;
        outline: none;
        -moz-appearance: none;
        -webkit-appearance: none;
        transition: color 0.2s ease-out, border-color 0.2s ease-out, background-color 0.2s ease-out, box-shadow 0.2s ease-out;
      }

      input[type=url] {
        background-color: rgb(247,247,247);
        margin-top: 0.6rem;
        width: 100%;
      }

      input[type=url]:focus {
        background-color: rgb(255,255,255);
        border-color: rgb(229,23,23);
        box-shadow: 0 0 0.3125rem rgba(229,23,23,0.5);
        color: rgb(229,23,23);
      }

      input[type=submit],
      a.download {
        background-color: rgb(229,23,23);
        border: 1px solid rgb(229,23,23);
        color: rgb(247,247,247);
        margin-top: 0.7rem;
        padding: 0.25rem 5%;
        text-align: center;
        text-decoration: none;
      }

      input[type=submit]:hover,
      input[type=submit]:focus,
      a.download:hover,
      a.download:focus {
        border-color: rgb(153,0,0);
        background-color: rgb(153,0,0);
        color: rgb(255,255,255);
      }

      img {
        height: auto;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <section id="main">
      <h1>Get Thumbnail of a Video</h1>
      <p>Have you ever needed a thumbnail of a video hosted on <strong>YouTube</strong> or <strong>Vimeo</strong>? Use this form to get it, and download it straight away â€¦</p>
      <form>
        <label for="video-url">Paste URL of video into this field:</label>
        <input id="video-url" type="url" placeholder="https://youtube.com/... or https://vimeo.com/..."/>
        <input id="submit" type="submit" value="Get Thumbnail">
      </form>
      <div id="result">
      </div>
    </section>
    <script>
      var section = document.getElementById('main');
      var container = document.getElementById('result');
      var videoURL = document.getElementById('video-url');
      var getURL = document.getElementById('submit');

      function parseURL (url) {
          // - Supported YouTube URL formats:
          //   - http://www.youtube.com/watch?v=My2FRPA3Gf8
          //   - http://youtu.be/My2FRPA3Gf8
          //   - https://youtube.googleapis.com/v/My2FRPA3Gf8
          //   - https://m.youtube.com/watch?v=My2FRPA3Gf8
          // - Supported Vimeo URL formats:
          //   - http://vimeo.com/25451551
          //   - http://player.vimeo.com/video/25451551
          // - Also supports relative URLs:
          //   - //player.vimeo.com/video/25451551

          url.match(/(http:|https:|)\/\/(player.|www.|m.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/);

          if (RegExp.$3.indexOf('youtu') > -1) {
              var type = 'youtube';
          } else if (RegExp.$3.indexOf('vimeo') > -1) {
              var type = 'vimeo';
          }

          return {
              type: type,
              id: RegExp.$6
          };
      }

      var appendThumb = (function(e) {
        var videoDetails = parseURL(videoURL.value);
        var videoType = videoDetails.type;
        var videoID = videoDetails.id;

        if (videoType == 'youtube') {
          var thumbSRC = 'https://img.youtube.com/vi/' + videoID + '/maxresdefault.jpg';
        }
        else if (videoType == 'vimeo') {
          var xhr = new XMLHttpRequest();
          xhr.open("GET", "https://vimeo.com/api/v2/video/"+ videoID +".json", true);
          xhr.onload = function (e) {
            if (xhr.readyState === 4) {
              if (xhr.status === 200) {
                var data = xhr.responseText;
                var parsedData = JSON.parse(data);
                thumbSRC = parsedData[0].thumbnail_large;
                thumbIMG.src = thumbSRC;
                thumbLINK.href = thumbSRC;
              } else {
                console.error(xhr.statusText);
              }
            }
          };
          xhr.onerror = function (e) {
            console.error(xhr.statusText);
          };
          xhr.send(null);
        }

        // Clear content of container
        container.innerHTML = "";

        // Set headline
        var headline = document.createElement('h2');
        if ((videoType == 'youtube') || (videoType == 'vimeo')) {
          headline.innerHTML = "Here you go:";
        }

        // Set paragraph
        var paragraph = document.createElement('p');
        paragraph.setAttribute('class', 'additional');
        if ((videoType == 'youtube') || (videoType == 'vimeo')) {
          paragraph.innerHTML = "The Thumbnail is associated to <a href='"+ videoURL.value +"' title='Link to video' target='_blank'>this video</a>. Please use it according to the copyrights.";
        }

        // Set image
        if ((videoType == 'youtube') || (videoType == 'vimeo')) {
          var thumbIMG = document.createElement('img');
          if (videoType == 'youtube') {
            thumbIMG.src = thumbSRC;
          }
          thumbIMG.alt = "Thumbnail of Video";
        }

        // Set link to download image, containing image
        if ((videoType == 'youtube') || (videoType == 'vimeo')) {
          var thumbLINK = document.createElement('a');
          if (videoType == 'youtube') {
            thumbLINK.href = thumbSRC;
          }
          thumbLINK.title = "Download Thumbnail";
          thumbLINK.text = "Download Thumbnail";
          thumbLINK.setAttribute('class', 'download');
          thumbLINK.setAttribute('download', 'thumbnail');
        }

        // Append Headline to the container
        container.appendChild(headline);
        // Append link containing image to the container
        if ((videoType == 'youtube') || (videoType == 'vimeo')) {
          container.appendChild(thumbIMG);
        }
        // Append download-link
        container.appendChild(thumbLINK);
        // Append paragraph to the container
        container.appendChild(paragraph);
        // Append container to the section
        section.appendChild(container);
        // prevent the form to submit and reload page
        e.preventDefault();
      });

      getURL.addEventListener('click', appendThumb);

    </script>
  </body>
</html>
